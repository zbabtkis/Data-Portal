<?php

function biogeog_portal_menu() {
	$items = array();
	$items['data/cec/portal'] = array(
		'title' => 'CEC Data Portal',
		'description' => t('Web portal for the CEC data collection'),
		'page callback' => 'biogeog_portal_page_gen',
		'access arguments' => array('access data portal'),
	  'type' => MENU_NORMAL_ITEM);
	return($items);
}
function biogeog_portal_page_gen() {
	$cec_data = array();
	$data_paths = scandir('/home/maxent');
	foreach($data_paths as $path) {
		if(ltrim($path,'.')) {
			$data_filenames[] = $path;
		}
	}
	for($i = 0, $l = count($data_filenames); $i < $l; $i++) {
		$cec_data[] = array('file_loc' => $data_filenames[$i]);
	}
	drupal_add_js(array('data-path' => $data_filenames, 'cec-data' => $cec_data, 'module_path'=> '/' . drupal_get_path('module','biogeog_portal') . '/inc/refreshLocation.php'), 'setting');
	$page = theme('biogeog_portal_template');
	return($page);
}
function biogeog_portal_permission() {
	$items = array();
	$items['access data portal'] = array(
		'title' => 'Access Data Portal Content',
		'description' => t('Access content from the biogeog data portal'));
	return($items);
}
function biogeog_portal_theme() {
	$themes = array(
		'biogeog_portal_template' => array(
			'template' => 'biogeog_portal_template',
		),
	);
	return($themes);
}
